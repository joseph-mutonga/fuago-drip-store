# System Architecture Overview

## ğŸ“ Application Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        CLIENT SIDE                           â”‚
â”‚                    (Browser / Frontend)                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚  index.html  â”‚  â”‚  login.html  â”‚  â”‚register.html â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚         â”‚                  â”‚                  â”‚              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚                  script.js                         â”‚      â”‚
â”‚  â”‚         (Fetch API, Event Handlers)                â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚                         â”‚                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚  user-dashboard.html  â”‚  upload.html (Admin)       â”‚      â”‚
â”‚  â”‚  cart.html  â”‚  checkout.html  â”‚  edit.html         â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚                         â”‚                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â”‚ HTTP/HTTPS (Port 3000)
                          â”‚ JSON Data Transfer
                          â”‚ JWT Token Authentication
                          â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      SERVER SIDE                              â”‚
â”‚                  (Node.js + Express)                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚      app.js        â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚      db.js         â”‚      â”‚
â”‚  â”‚  (Main Express     â”‚          â”‚  (MySQL Pool)      â”‚      â”‚
â”‚  â”‚   Application)     â”‚          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚                 â”‚
â”‚            â”‚                               â”‚                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”‚                 â”‚
â”‚  â”‚   Middleware       â”‚                    â”‚                 â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                    â”‚                 â”‚
â”‚  â”‚ - CORS             â”‚                    â”‚                 â”‚
â”‚  â”‚ - Body Parser      â”‚                    â”‚                 â”‚
â”‚  â”‚ - Multer (Upload)  â”‚                    â”‚                 â”‚
â”‚  â”‚ - Static Files     â”‚                    â”‚                 â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚                 â”‚
â”‚            â”‚                               â”‚                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”‚                 â”‚
â”‚  â”‚   Route Handlers   â”‚                    â”‚                 â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                    â”‚                 â”‚
â”‚  â”‚ authRoutes.js      â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                 â”‚
â”‚  â”‚ - /auth/register   â”‚   Database Queries â”‚                 â”‚
â”‚  â”‚ - /auth/login      â”‚                    â”‚                 â”‚
â”‚  â”‚ - /auth/me         â”‚                    â”‚                 â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                    â”‚                 â”‚
â”‚  â”‚ Product Routes     â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                 â”‚
â”‚  â”‚ - /products (GET)  â”‚                    â”‚                 â”‚
â”‚  â”‚ - /upload (POST)   â”‚                    â”‚                 â”‚
â”‚  â”‚ - /update/:id      â”‚                    â”‚                 â”‚
â”‚  â”‚ - /delete/:id      â”‚                    â”‚                 â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                    â”‚                 â”‚
â”‚  â”‚ cartRoutes.js      â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                 â”‚
â”‚  â”‚ - /user/cart       â”‚                    â”‚                 â”‚
â”‚  â”‚ - /user/cart/add   â”‚                    â”‚                 â”‚
â”‚  â”‚ - /user/checkout   â”‚                    â”‚                 â”‚
â”‚  â”‚ - /user/orders     â”‚                    â”‚                 â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                    â”‚                 â”‚
â”‚  â”‚ adminRoutes.js     â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                 â”‚
â”‚  â”‚ - /admin/users     â”‚                    â”‚                 â”‚
â”‚  â”‚ - /admin/orders    â”‚                    â”‚                 â”‚
â”‚  â”‚ - /admin/user/:id  â”‚                    â”‚                 â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚                 â”‚
â”‚            â”‚                               â”‚                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”‚                 â”‚
â”‚  â”‚   Auth Middleware  â”‚                    â”‚                 â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                    â”‚                 â”‚
â”‚  â”‚ - verifyToken      â”‚                    â”‚                 â”‚
â”‚  â”‚ - isAdmin          â”‚                    â”‚                 â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚                 â”‚
â”‚                                            â”‚                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                             â”‚
                                             â”‚ MySQL Protocol
                                             â”‚ Port 3306
                                             â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     DATABASE LAYER                            â”‚
â”‚               (MySQL Community Server)                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚              image_upload_db                        â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚    users     â”‚  â”‚   products   â”‚  â”‚     cart     â”‚       â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤       â”‚
â”‚  â”‚ id (PK)      â”‚  â”‚ id (PK)      â”‚  â”‚ id (PK)      â”‚       â”‚
â”‚  â”‚ username     â”‚  â”‚ name         â”‚  â”‚ user_id (FK) â”‚â”€â”€â”€â”   â”‚
â”‚  â”‚ email        â”‚  â”‚ description  â”‚  â”‚ product_id   â”‚   â”‚   â”‚
â”‚  â”‚ password     â”‚  â”‚ price        â”‚  â”‚ quantity     â”‚   â”‚   â”‚
â”‚  â”‚ role         â”‚  â”‚ quantity     â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚
â”‚  â”‚ created_at   â”‚  â”‚ image        â”‚         â”‚           â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ created_at   â”‚         â”‚           â”‚   â”‚
â”‚         â”‚          â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚           â”‚   â”‚
â”‚         â”‚                 â”‚                 â”‚           â”‚   â”‚
â”‚         â”‚                 â”‚        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚
â”‚         â”‚                 â”‚        â”‚  Foreign Keys  â”‚   â”‚   â”‚
â”‚         â”‚                 â”‚        â”‚  & Relations   â”‚   â”‚   â”‚
â”‚         â”‚                 â”‚        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚
â”‚         â”‚                 â”‚                             â”‚   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â” â”‚
â”‚  â”‚                    Relationships                        â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚ users (1) â†â†’ (Many) cart                               â”‚ â”‚
â”‚  â”‚ users (1) â†â†’ (Many) orders                             â”‚ â”‚
â”‚  â”‚ products (1) â†â†’ (Many) cart                            â”‚ â”‚
â”‚  â”‚ products (1) â†â†’ (Many) order_items                     â”‚ â”‚
â”‚  â”‚ orders (1) â†â†’ (Many) order_items                       â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                          â”‚
â”‚  â”‚   orders     â”‚  â”‚ order_items  â”‚                          â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                          â”‚
â”‚  â”‚ id (PK)      â”‚  â”‚ id (PK)      â”‚                          â”‚
â”‚  â”‚ user_id (FK) â”‚  â”‚ order_id (FK)â”‚                          â”‚
â”‚  â”‚ total_amount â”‚  â”‚ product_id   â”‚                          â”‚
â”‚  â”‚ payment_methodâ”‚ â”‚ quantity     â”‚                          â”‚
â”‚  â”‚ status       â”‚  â”‚ price        â”‚                          â”‚
â”‚  â”‚ created_at   â”‚  â”‚ created_at   â”‚                          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                          â”‚
â”‚                                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ Data Flow Examples

### 1ï¸âƒ£ User Login Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    POST /auth/login     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º   â”‚          â”‚
â”‚  Client  â”‚   {email, password}      â”‚  Server  â”‚
â”‚ (Browser)â”‚                          â”‚ (Express)â”‚
â”‚          â”‚  â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  {token, user, redirect} â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
                                            â”‚
                                            â”‚ SELECT * FROM users
                                            â”‚ WHERE email = ?
                                            â”‚
                                      â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”
                                      â”‚   MySQL   â”‚
                                      â”‚ Database  â”‚
                                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Steps:**
1. User enters email & password in `login.html`
2. Frontend sends POST to `/auth/login`
3. Server queries `users` table
4. bcrypt compares password hash
5. JWT token generated
6. Token + user info returned
7. Token stored in localStorage
8. User redirected to dashboard

---

### 2ï¸âƒ£ Add to Cart Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  POST /user/cart/add    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º   â”‚          â”‚
â”‚  Client  â”‚  {product_id}            â”‚  Server  â”‚
â”‚          â”‚  Authorization: Bearer   â”‚          â”‚
â”‚          â”‚       <JWT>              â”‚          â”‚
â”‚          â”‚  â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  {message: "Added"}      â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
                                            â”‚
                                            â”‚ 1. Verify JWT
                                            â”‚ 2. Extract user_id
                                            â”‚ 3. Check if exists
                                            â”‚ 4. INSERT or UPDATE
                                            â”‚
                                      â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”
                                      â”‚   MySQL   â”‚
                                      â”‚   cart    â”‚
                                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### 3ï¸âƒ£ Checkout Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  POST /user/checkout    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º   â”‚          â”‚
â”‚  Client  â”‚  {cart[], payment}       â”‚  Server  â”‚
â”‚          â”‚                          â”‚          â”‚
â”‚          â”‚  â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  {message, redirect}     â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
                                            â”‚
                                            â”‚ TRANSACTION:
                                            â”‚ 1. Check stock
                                            â”‚ 2. Reduce quantity
                                            â”‚ 3. Create order
                                            â”‚ 4. Create order_items
                                            â”‚ 5. Clear cart
                                            â”‚
                                      â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”
                                      â”‚   MySQL   â”‚
                                      â”‚  Database â”‚
                                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ” Security Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     Security Layers                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                           â”‚
â”‚  Layer 1: Input Validation                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ - Frontend: Form validation                        â”‚  â”‚
â”‚  â”‚ - Backend: Request body validation                 â”‚  â”‚
â”‚  â”‚ - Type checking                                    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                           â”‚
â”‚  Layer 2: Authentication & Authorization                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ - JWT Token Verification                           â”‚  â”‚
â”‚  â”‚ - Role-based Access Control (RBAC)                 â”‚  â”‚
â”‚  â”‚ - Middleware: verifyToken, isAdmin                 â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                           â”‚
â”‚  Layer 3: Data Protection                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ - Password Hashing (bcrypt)                        â”‚  â”‚
â”‚  â”‚ - Environment Variables (.env)                     â”‚  â”‚
â”‚  â”‚ - Secure Token Storage                             â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                           â”‚
â”‚  Layer 4: Database Security                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ - Parameterized Queries (SQL Injection Prevention) â”‚  â”‚
â”‚  â”‚ - Foreign Key Constraints                          â”‚  â”‚
â”‚  â”‚ - Transaction Management                           â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                           â”‚
â”‚  Layer 5: Network Security                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ - CORS Configuration                               â”‚  â”‚
â”‚  â”‚ - Rate Limiting (recommended)                      â”‚  â”‚
â”‚  â”‚ - HTTPS (production)                               â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ—‚ï¸ File Structure

```
indian/
â”‚
â”œâ”€â”€ ğŸ“ database/
â”‚   â””â”€â”€ schema.sql          # Complete database schema
â”‚
â”œâ”€â”€ ğŸ“ middleware/
â”‚   â”œâ”€â”€ auth.js             # JWT verification & role check
â”‚   â”œâ”€â”€ isAdmin.js          # Admin authorization
â”‚   â””â”€â”€ verifyToken.js      # Token validation
â”‚
â”œâ”€â”€ ğŸ“ public/              # Frontend files
â”‚   â”œâ”€â”€ index.html          # Landing page
â”‚   â”œâ”€â”€ login.html          # Login interface
â”‚   â”œâ”€â”€ register.html       # Registration form
â”‚   â”œâ”€â”€ user-dashboard.html # User product view
â”‚   â”œâ”€â”€ upload.html         # Admin dashboard
â”‚   â”œâ”€â”€ cart.html           # Shopping cart
â”‚   â”œâ”€â”€ checkout.html       # Order checkout
â”‚   â”œâ”€â”€ edit.html           # Product editor
â”‚   â”œâ”€â”€ script.js           # Client-side logic
â”‚   â””â”€â”€ style.css           # Styling
â”‚
â”œâ”€â”€ ğŸ“ routes/
â”‚   â”œâ”€â”€ authRoutes.js       # Authentication API
â”‚   â”œâ”€â”€ cartRoutes.js       # Cart & orders API
â”‚   â””â”€â”€ adminRoutes.js      # Admin management API
â”‚
â”œâ”€â”€ ğŸ“ uploads/             # Product images storage
â”‚   â””â”€â”€ .gitkeep            # Keep directory in git
â”‚
â”œâ”€â”€ ğŸ“„ app.js               # Main Express application
â”œâ”€â”€ ğŸ“„ db.js                # MySQL connection pool
â”œâ”€â”€ ğŸ“„ setup-database.js    # Database initialization script
â”œâ”€â”€ ğŸ“„ test-database.js     # Database verification script
â”œâ”€â”€ ğŸ“„ package.json         # Dependencies & scripts
â”œâ”€â”€ ğŸ“„ .env                 # Environment configuration
â”œâ”€â”€ ğŸ“„ .env.example         # Environment template
â”œâ”€â”€ ğŸ“„ .gitignore           # Git ignore rules
â”œâ”€â”€ ğŸ“„ README.md            # Project documentation
â”œâ”€â”€ ğŸ“„ DATABASE_SETUP_GUIDE.md  # Setup instructions
â”œâ”€â”€ ğŸ“„ SETUP_COMPLETE.md    # Verification report
â””â”€â”€ ğŸ“„ ARCHITECTURE.md      # This file
```

---

## ğŸ“Š Database Schema Visualization

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     users       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â€¢ id (PK)       â”‚
â”‚   username      â”‚
â”‚   email (UK)    â”‚
â”‚   password      â”‚
â”‚   role          â”‚
â”‚   created_at    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ 1:N
         â”‚
    â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚    cart     â”‚  N:1    â”‚  products    â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”€â”€â”€â”€â”€â”€â”€â–ºâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚ â€¢ id (PK)   â”‚         â”‚ â€¢ id (PK)    â”‚
    â”‚   user_id   â”‚         â”‚   name       â”‚
    â”‚   product_idâ”‚â—„â”€â”€â”€â”€â”   â”‚   descriptionâ”‚
    â”‚   quantity  â”‚     â”‚   â”‚   price      â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚   â”‚   quantity   â”‚
                        â”‚   â”‚   image      â”‚
         â”‚              â”‚   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚              â”‚          â”‚
         â”‚ 1:N          â”‚ N:1      â”‚ 1:N
         â”‚              â”‚          â”‚
    â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚     â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚   orders    â”‚    â”‚     â”‚ order_items  â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”‚     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚ â€¢ id (PK)   â”‚    â”‚     â”‚ â€¢ id (PK)    â”‚
    â”‚   user_id   â”‚    â”‚     â”‚   order_id   â”‚
    â”‚   total_amt â”‚    â”‚     â”‚   product_id â”‚â”€â”˜
    â”‚   payment   â”‚    â”‚     â”‚   quantity   â”‚
    â”‚   status    â”‚    â”‚     â”‚   price      â”‚
    â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚            â”‚
          â”‚ 1:N        â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Legend:**
- `â€¢` = Primary Key
- `UK` = Unique Key
- `FK` = Foreign Key
- `1:N` = One-to-Many Relationship
- `N:1` = Many-to-One Relationship

---

## ğŸ”„ Request/Response Cycle

### Complete HTTP Request Example

```
1. USER ACTION
   â””â”€â–º Click "Add to Cart" button

2. FRONTEND (script.js)
   â”œâ”€â–º Validate product_id
   â”œâ”€â–º Get JWT token from localStorage
   â”œâ”€â–º Build request:
   â”‚   {
   â”‚     method: 'POST',
   â”‚     headers: {
   â”‚       'Content-Type': 'application/json',
   â”‚       'Authorization': 'Bearer eyJhbG...'
   â”‚     },
   â”‚     body: JSON.stringify({ product_id: 1 })
   â”‚   }
   â””â”€â–º fetch('http://localhost:3000/user/cart/add', request)

3. NETWORK
   â””â”€â–º HTTP POST to server (Port 3000)

4. BACKEND (app.js)
   â”œâ”€â–º CORS middleware âœ“
   â”œâ”€â–º Body parser âœ“
   â”œâ”€â–º Route to /user/* â†’ cartRoutes.js
   â””â”€â–º verifyToken middleware
       â”œâ”€â–º Extract JWT from header
       â”œâ”€â–º Verify signature
       â”œâ”€â–º Decode payload â†’ req.user = { id, username, role }
       â””â”€â–º next()

5. ROUTE HANDLER (cartRoutes.js)
   â”œâ”€â–º Get user_id from req.user.id
   â”œâ”€â–º Get product_id from req.body
   â””â”€â–º Database query

6. DATABASE (MySQL)
   â”œâ”€â–º Check if item exists in cart
   â”œâ”€â–º If exists: UPDATE quantity
   â”œâ”€â–º If not: INSERT new row
   â””â”€â–º Return result

7. BACKEND RESPONSE
   â””â”€â–º res.json({ message: "Product added to cart" })

8. NETWORK
   â””â”€â–º HTTP 200 OK with JSON body

9. FRONTEND
   â”œâ”€â–º Parse response
   â”œâ”€â–º Update cart count in UI
   â””â”€â–º Show success message

10. USER FEEDBACK
    â””â”€â–º "Added to cart!" notification
```

---

## ğŸš€ Performance Considerations

### Connection Pooling
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     Connection Pool (30)        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [Conn1] [Conn2] [Conn3] ...     â”‚
â”‚                                 â”‚
â”‚ â–² Request comes in              â”‚
â”‚ â”‚ Borrow connection             â”‚
â”‚ â”‚ Execute query                 â”‚
â”‚ â”‚ Return connection             â”‚
â”‚ â””â”€â–º Reuse for next request      â”‚
â”‚                                 â”‚
â”‚ Benefits:                       â”‚
â”‚ â€¢ Faster query execution        â”‚
â”‚ â€¢ Reduced connection overhead   â”‚
â”‚ â€¢ Better resource management    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Indexing Strategy
```sql
-- Users table
INDEX idx_email ON users(email)      -- Fast login lookup
INDEX idx_role ON users(role)         -- Admin queries

-- Products table
INDEX idx_name ON products(name)      -- Search functionality
INDEX idx_price ON products(price)    -- Price sorting

-- Cart table
INDEX idx_user_id ON cart(user_id)   -- User cart queries

-- Orders table
INDEX idx_user_id ON orders(user_id)     -- Order history
INDEX idx_status ON orders(status)        -- Status filtering
INDEX idx_created_at ON orders(created_at) -- Date sorting
```

---

## ğŸ¯ This Architecture Provides

âœ… **Scalability**: Connection pooling, efficient queries  
âœ… **Security**: Multi-layer protection, encryption  
âœ… **Maintainability**: Modular structure, clear separation  
âœ… **Performance**: Indexed database, async operations  
âœ… **Reliability**: Error handling, transaction management  
âœ… **Flexibility**: Easy to extend with new features  

---

**Last Updated:** January 11, 2026  
**Version:** 1.0  
**Status:** Production Ready  
